<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Random Google Fonts â€” Demo</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background:#f8f9fb; }
    .font-card { cursor:pointer; transition:transform .15s ease; }
    .font-card:hover { transform: translateY(-4px); }
    #preview { min-height: 120px; border-radius: .5rem; padding: 1.25rem; }
    .muted { color:#6c757d; }
  </style>
</head>
<body class="p-3 p-md-5">

  <div class="container">
    <div class="row mb-4 align-items-center">
      <div class="col-md-6">
        <h1 class="h3 mb-1">ðŸŽ² Random Google Fonts</h1>
        <p class="muted mb-0">Get a random font, preview it, or pick from the list. Works with a Google Fonts API key or with a built-in fallback list.</p>
      </div>
      <div class="col-md-6 text-md-end mt-3 mt-md-0">
        <div class="btn-group" role="group">
          <button id="randomBtn" class="btn btn-primary">ðŸŽ² Random Font</button>
          <button id="refreshListBtn" class="btn btn-outline-secondary">âŸ³ Refresh List</button>
        </div>
      </div>
    </div>

    <div class="row g-3">
      <div class="col-lg-5">
        <div class="card shadow-sm">
          <div class="card-body">
            <div class="mb-3">
              <label class="form-label">Google Fonts API Key (optional)</label>
              <input id="apiKey" class="form-control" placeholder="Paste API key here (optional)" />
              <div class="form-text">Leave empty to use the built-in font list fallback (no key required).</div>
            </div>

            <div class="mb-3">
              <label class="form-label">Choose font</label>
              <select id="fontSelect" class="form-select" size="10" style="height:320px;"></select>
            </div>

            <div class="d-flex gap-2">
              <button id="applyBtn" class="btn btn-success w-100">Apply Selected</button>
              <button id="loadAllBtn" class="btn btn-outline-secondary">Load Sample List</button>
            </div>

            <hr />
            <div class="small text-muted">Tips: Click a font in the list and press Apply. Random chooses one for you.</div>
          </div>
        </div>
      </div>

      <div class="col-lg-7">
        <div class="card shadow-sm">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-start mb-3">
              <div>
                <strong id="currentFont">System UI</strong>
                <div class="muted small" id="fontMeta">No font loaded</div>
              </div>
              <div class="text-end">
                <small class="muted">Preview size</small>
                <div class="mt-1">
                  <input id="sizeRange" type="range" min="16" max="72" value="28" />
                </div>
              </div>
            </div>

            <div id="preview" class="border bg-white">
              <p id="previewText" style="font-size:28px; margin:0;">
                The quick brown fox jumps over the lazy dog. 0123456789 â€” Preview your selected font.
              </p>
            </div>

            <div class="mt-3">
              <label class="form-label">Insert sample text</label>
              <textarea id="sampleInput" class="form-control" rows="2" placeholder="Type your preview text..."></textarea>
              <div class="mt-2 d-flex gap-2">
                <button id="updateTextBtn" class="btn btn-outline-primary btn-sm">Update Preview</button>
                <button id="resetTextBtn" class="btn btn-outline-secondary btn-sm">Reset</button>
              </div>
            </div>
          </div>
        </div>

        <div class="mt-3 text-muted small">Source: Google Fonts Developer API (requires API key) â€” fallback uses a cached list of popular fonts.</div>
      </div>
    </div>
  </div>

  <script>
  // ---------- Config ----------
  const GOOGLE_FONTS_API_URL = "https://www.googleapis.com/webfonts/v1/webfonts";

  // Predefined popular fonts
  const POPULAR_FONTS = [
    "Roboto","Open Sans","Lato","Montserrat","Poppins","Raleway",
    "Merriweather","Playfair Display","Source Sans Pro","Nunito",
    "Oswald","Ubuntu","Dancing Script","Indie Flower","Pacifico"
  ];

  // ---------- DOM ----------
  const apiKeyInput = document.getElementById("apiKey");
  const fontSelect = document.getElementById("fontSelect");
  const applyBtn = document.getElementById("applyBtn");
  const randomBtn = document.getElementById("randomBtn");
  const loadAllBtn = document.getElementById("loadAllBtn");
  const refreshListBtn = document.getElementById("refreshListBtn");
  const previewText = document.getElementById("previewText");
  const currentFontLabel = document.getElementById("currentFont");
  const fontMeta = document.getElementById("fontMeta");
  const sizeRange = document.getElementById("sizeRange");
  const sampleInput = document.getElementById("sampleInput");
  const updateTextBtn = document.getElementById("updateTextBtn");
  const resetTextBtn = document.getElementById("resetTextBtn");

  let fontsList = [];
  let lastInsertedLinkId = null;

  // ---------- Helpers ----------
  function makeGoogleFontsLink(family) {
    const familyForUrl = family.replace(/\s+/g, "+");
    return `https://fonts.googleapis.com/css2?family=${familyForUrl}&display=swap`;
  }

  function insertFontLink(url, id) {
    if (lastInsertedLinkId) {
      const prev = document.getElementById(lastInsertedLinkId);
      if (prev) prev.remove();
    }
    const link = document.createElement("link");
    link.rel = "stylesheet";
    link.href = url;
    link.id = id;
    document.head.appendChild(link);
    lastInsertedLinkId = id;
  }

  async function loadFontAndApply(family) {
    try {
      const cssUrl = makeGoogleFontsLink(family);
      const uniqId = "gf-" + family.replace(/\s+/g, "-").toLowerCase();
      insertFontLink(cssUrl, uniqId);
      await document.fonts.load(`1rem "${family}"`);
      previewText.style.fontFamily = `"${family}", sans-serif`;
      currentFontLabel.textContent = family;
      fontMeta.textContent = `Loaded font: ${family}`;
    } catch (err) {
      console.error("Font load error:", err);
      fontMeta.textContent = `Failed to load font: ${family}`;
    }
  }

  function populateSelect(list) {
    fontSelect.innerHTML = "";
    list.forEach(f => {
      const opt = document.createElement("option");
      opt.value = f;
      opt.textContent = f;
      fontSelect.appendChild(opt);
    });
  }

  function pickRandom(list) {
    return list[Math.floor(Math.random() * list.length)];
  }

  async function fetchFontsFromGoogle(apiKey) {
    const url = `${GOOGLE_FONTS_API_URL}?key=${encodeURIComponent(apiKey)}&sort=popularity`;
    const res = await fetch(url);
    if (!res.ok) throw new Error("Google Fonts API request failed: " + res.status);
    const json = await res.json();
    return json.items.map(item => item.family);
  }

  // ---------- UI events ----------
  applyBtn.addEventListener("click", async () => {
    const family = fontSelect.value;
    if (!family) return alert("Pick a font first");
    currentFontLabel.textContent = "Loadingâ€¦";
    await loadFontAndApply(family);
  });

  randomBtn.addEventListener("click", async () => {
    if (!fontsList.length) await loadFontsList();
    const family = pickRandom(fontsList);
    fontSelect.value = family;
    await loadFontAndApply(family);
  });

  loadAllBtn.addEventListener("click", () => {
    populateSelect(POPULAR_FONTS);
    fontsList = POPULAR_FONTS;
    fontMeta.textContent = `Loaded ${fontsList.length} popular fonts`;
  });

  refreshListBtn.addEventListener("click", async () => {
    await loadFontsList();
  });

  sizeRange.addEventListener("input", () => {
    previewText.style.fontSize = sizeRange.value + "px";
  });

  updateTextBtn.addEventListener("click", () => {
    if (sampleInput.value.trim()) {
      previewText.textContent = sampleInput.value.trim();
    }
  });

  resetTextBtn.addEventListener("click", () => {
    sampleInput.value = "";
    previewText.textContent = "The quick brown fox jumps over the lazy dog. 0123456789 â€” Preview your selected font.";
  });

  async function loadFontsList() {
    const apiKey = apiKeyInput.value.trim();
    try {
      fontsList = apiKey ? await fetchFontsFromGoogle(apiKey) : POPULAR_FONTS;
      populateSelect(fontsList);
      fontMeta.textContent = `Loaded ${fontsList.length} fonts (${apiKey ? "Google API" : "Popular"})`;
    } catch (err) {
      console.warn(err);
      fontsList = POPULAR_FONTS;
      populateSelect(fontsList);
      fontMeta.textContent = "Using fallback font list.";
    }
  }

  // Init
  (async function init() {
    await loadFontsList();
  })();
  </script>
</body>
</html>
